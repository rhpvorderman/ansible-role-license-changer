- hosts: localhost
  become: no
  vars:
    test_files:
      - regexp: ".sh$"
        prefix: "# "
        suffix: ""
        after: "#!/bin/bash"
        end: "^$"
        marker: "#\t\t"
      - regexp: ".py$"
        prefix: "# "
        suffix: ""
        before: "BOF"
        end: "^$"
        marker: "#\t\t"
      #- regexp: ".scala$"
      #  prefix: "  * "
      #  suffix: ""
      #  after: "/**"
      #  end: "*/"
      #  marker: "// "
      - regexp: ".yaml.test$"
        prefix: "#"
        suffix: ""
        after: "---$"
        end: "^$"
        marker: "#\t\t"
  tasks:
    - name: Run license changer on test files
      include_role:
        name: license-changer
      vars:
        license_changer_project_dir: "{{playbook_dir}}/tests/files"
        license_changer_project_file_regexp: "{{test_item.regexp}}"
        license_changer_header_prefix: "{{test_item.prefix}}"
        license_changer_header_suffix: "{{test_item.suffix}}"
        license_changer_header_before: "{{test_item.before | default(omit)}}"
        license_changer_header_after: "{{test_item.after | default(omit)}}"
        license_changer_header_marker: "{{test_item.marker}}"
      with_items: "{{test_files}}"
      loop_control:
        loop_var: test_item
